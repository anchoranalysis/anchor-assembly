<?xml version="1.0" encoding="ISO-8859-1" ?>
<config>
<bean config-class="java.util.List" config-factory="list">

	<!-- Read images using Bioformats -->
	<item config-class="org.anchoranalysis.bean.NamedBean" name="org.anchoranalysis.image.io.bean.stack.StackReader">
		<item config-class="org.anchoranalysis.io.bioformats.bean.BioformatsReader">
			<options config-class="org.anchoranalysis.io.bioformats.bean.options.ForceBitsPerPixel" bitsPerPixel="8">
				<options config-class="org.anchoranalysis.io.bioformats.bean.options.ForceTimeSeriesToStack"/>
			</options>
		</item>
	</item>
	
	<!-- Write PNGs (for single or three-channeled 2D images) or Tiffs (for single or three-channeled 3D images) or OME-TIFFs for everything else. -->
	<item config-class="org.anchoranalysis.bean.NamedBean" name="org.anchoranalysis.image.io.bean.stack.StackWriter">
		<item config-class="org.anchoranalysis.plugin.io.bean.stack.writer.BranchChannels">
			
			<!--  Catch all writer that can support almost any combination of channels / stacks  -->
			<writer config-class="org.anchoranalysis.plugin.io.bean.stack.writer.bioformats.OMETiff"/>

			<!-- If it's guaranteed to be RGB (three channels) use a PNG if guaranteed to be 2D, or a TIFF otherwise -->
			<whenRGB config-class="org.anchoranalysis.plugin.io.bean.stack.writer.BranchStack">
				<writerAlways2D config-class="org.anchoranalysis.io.imagej.bean.stack.writer.PNG"/>
				<writerElse config-class="org.anchoranalysis.plugin.io.bean.stack.writer.bioformats.Tiff"/>
			</whenRGB>
			
			<!-- Likewise if it's guaranteed to be one or three channels, use a PNG if guranteed to be 2D, or a TIFF otherwise -->
			<whenOneOrThreeChannels config-class="org.anchoranalysis.plugin.io.bean.stack.writer.BranchStack">
				<writerAlways2D config-class="org.anchoranalysis.io.imagej.bean.stack.writer.PNG"/>
				<writerElse config-class="org.anchoranalysis.plugin.io.bean.stack.writer.bioformats.Tiff"/>
			</whenOneOrThreeChannels>
		</item>
	</item>
	
</bean>
</config>